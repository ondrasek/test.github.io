<ul>
<li>
{% assign cYear = "" %}
{% assign cMonth = "" %}
{% assign posts = site.posts | sort: 'date' | reverse %}
{% assign first = posts | first %}
{% assign cMonthName = "" %}
{% assign count = 0 %}

{% for post in posts %}
  {% assign count = count | plus: 1 %}
  {% assign year = (post.date | date: '%Y') %}
  {% assign month = post.date | date: '%Y-%m' %}
  {% if year != cYear %}
    {% if cYear != "" %}
      {{cMonthName}} ({{count | minus: 1}})</li></ul></li><li>
      {% assign count = 1 %}
    {% endif %}
    {{year}}<ul><li>
    {% assign cMonthName = "" %}
    {% assign cMonth = "" %}
    {% assign cYear = year %}
  {% endif %}

  {% if month != cMonth %}
    {% if cMonth != "" %}
      {{cMonthName}} ({{count | minus: 1}})</li><li>
      {% assign count = 1 %}
    {% endif %}
    {% assign cMonth = month %}
  {% endif %}
  {% assign cMonthName = post.date | date: '%B' %}
{% endfor %}
{{cMonthName}} ({{count}})
</li>
</ul>
</li>
</ul>
